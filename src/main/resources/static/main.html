<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>메인 메뉴</title>
</head>
<body>
  <h2>메인 메뉴</h2>
  <div id="userInfo"></div>
  <button onclick="logout()">로그아웃</button>

  <script>
    async function fetchUserInfo() {
      const token = localStorage.getItem("token");
      if (!token) {
        alert("로그인 필요");
        location.href = "/login.html";
        return;
      }

      const response = await fetch("/api/users/me", {
        headers: {
          "Authorization": "Bearer " + token
        }
      });

      if (response.ok) {
        const user = await response.json();
        document.getElementById("userInfo").innerText = `환영합니다, ${user.username}님!`;
      } else {
        alert("인증 실패. 다시 로그인해주세요.");
        localStorage.removeItem("token");
        location.href = "/login.html";
      }
    }

    function logout() {
      localStorage.removeItem("token");
      location.href = "/login.html";
    }

    fetchUserInfo();
  </script>
</body>
</html>